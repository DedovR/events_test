# Запуск сервиса

Для работы нужен docker, go

1. Копируем конфиг
```bash
cp .env.example .env
```
2. Запускаем mongo в контейнере

```bash
make up
```
3. Запускаем приложение
```bash
make start
```
4. Запросы
```bash
# start event
curl --location 'localhost:8080/v1/start' --header 'Content-Type: application/json' --data '{"type":"test"}'

# finish event
curl --location 'localhost:8080/v1/finish' --header 'Content-Type: application/json' --data '{"type":"test"}'

# show events
curl --location 'localhost:8080/v1'
```

## TODO-list

- Написать тесты
- Проверить корнер-кейсы
- Добавить миграции
- Накинуть индексы на type, created_at?
- Добавить промежуточную таблицу active_events, чтобы ускорить проверку для ручек start/finish

## Сервис хранения событий

Ваша задача написать сервис, который реализует API создания и завершения разных событий. События могут быть разных типов. В базе данных может быть только одно незавершенное событие одного типа.

### Методы API

Полную спецификацию методов см. в [openapi/task.yaml](openapi/task.yaml)

`GET /v1`

Метод возвращает список событий отсортированных по дате начала

`POST /v1/start`

Метод создает событие переданного типа. Если в базе уже есть незавершенное событие переданного типа, то новое событие создавать не нужно, и в ответ не должно приходить сообщение об ошибке.

`POST /v1/finish`

Метод завершает событие переданного типа. Если незавершенного события такого типа в БД не найдено, должна вернуться 404 ошибка.

### База данных

База данных должна быть MongoDB.
События всех типов должны храниться отдельными документами в одной коллекции.

Пример документа в коллекции:

    {
        "_id": "...",
        "type": "...",
        "state": 0, // state 0 - для незавершенных событий, 1 - для завершенных
        "started_at": "...", // Время начала события
        "finished_at": "...", // Время завершения события
    }

Если необходимо, документ может быть расширен.
